tinyMCEPopup.requireLangPack();var LinkDialog={preInit:function(){var t;(t=tinyMCEPopup.getParam("external_link_list_url"))&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(t)+'"></script>')},init:function(){var t=document.forms[0],i=tinyMCEPopup.editor;document.getElementById("hrefbrowsercontainer").innerHTML=getBrowserHTML("hrefbrowser","href","file","theme_advanced_link"),isVisible("hrefbrowser")&&(document.getElementById("href").style.width="180px"),this.fillClassList("class_list"),this.fillFileList("link_list","tinyMCELinkList"),this.fillTargetList("target_list"),(e=i.dom.getParent(i.selection.getNode(),"A"))&&(t.href.value=i.dom.getAttrib(e,"href"),t.linktitle.value=i.dom.getAttrib(e,"title"),t.insert.value=i.getLang("update"),selectByValue(t,"link_list",t.href.value),selectByValue(t,"target_list",i.dom.getAttrib(e,"target")),selectByValue(t,"class_list",i.dom.getAttrib(e,"class")))},update:function(){var t,e,i=document.forms[0],n=tinyMCEPopup.editor,l=i.href.value.replace(/ /g,"%20");return tinyMCEPopup.restoreSelection(),t=n.dom.getParent(n.selection.getNode(),"A"),!i.href.value&&t?(e=n.selection.getBookmark(),n.dom.remove(t,1),n.selection.moveToBookmark(e),tinyMCEPopup.execCommand("mceEndUndoLevel"),tinyMCEPopup.close(),void 0):(null==t?(n.getDoc().execCommand("unlink",!1,null),tinyMCEPopup.execCommand("mceInsertLink",!1,"#mce_temp_url#",{skip_undo:1}),tinymce.each(n.dom.select("a"),function(e){"#mce_temp_url#"==n.dom.getAttrib(e,"href")&&(t=e,n.dom.setAttribs(t,{href:l,title:i.linktitle.value,target:i.target_list?getSelectValue(i,"target_list"):null,"class":i.class_list?getSelectValue(i,"class_list"):null}))})):n.dom.setAttribs(t,{href:l,title:i.linktitle.value,target:i.target_list?getSelectValue(i,"target_list"):null,"class":i.class_list?getSelectValue(i,"class_list"):null}),(1!=t.childNodes.length||"IMG"!=t.firstChild.nodeName)&&(n.focus(),n.selection.select(t),n.selection.collapse(0),tinyMCEPopup.storeSelection()),tinyMCEPopup.execCommand("mceEndUndoLevel"),tinyMCEPopup.close(),void 0)},checkPrefix:function(t){t.value&&Validator.isEmail(t)&&!/^\s*mailto:/i.test(t.value)&&confirm(tinyMCEPopup.getLang("advanced_dlg.link_is_email"))&&(t.value="mailto:"+t.value),/^\s*www\./i.test(t.value)&&confirm(tinyMCEPopup.getLang("advanced_dlg.link_is_external"))&&(t.value="http://"+t.value)},fillFileList:function(t,e){var i=tinyMCEPopup.dom,n=i.get(t);e=window[e],e&&e.length>0?(n.options[n.options.length]=new Option("",""),tinymce.each(e,function(t){n.options[n.options.length]=new Option(t[0],t[1])})):i.remove(i.getParent(t,"tr"))},fillClassList:function(t){var e,i,n=tinyMCEPopup.dom,l=n.get(t);(e=tinyMCEPopup.getParam("theme_advanced_styles"))?(i=[],tinymce.each(e.split(";"),function(t){var e=t.split("=");i.push({title:e[0],"class":e[1]})})):i=tinyMCEPopup.editor.dom.getClasses(),i.length>0?(l.options[l.options.length]=new Option(tinyMCEPopup.getLang("not_set"),""),tinymce.each(i,function(t){l.options[l.options.length]=new Option(t.title||t["class"],t["class"])})):n.remove(n.getParent(t,"tr"))},fillTargetList:function(t){var e,i=tinyMCEPopup.dom,n=i.get(t);n.options[n.options.length]=new Option(tinyMCEPopup.getLang("not_set"),""),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("advanced_dlg.link_target_same"),"_self"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("advanced_dlg.link_target_blank"),"_blank"),(e=tinyMCEPopup.getParam("theme_advanced_link_targets"))&&tinymce.each(e.split(","),function(t){t=t.split("="),n.options[n.options.length]=new Option(t[0],t[1])})}};LinkDialog.preInit(),tinyMCEPopup.onInit.add(LinkDialog.init,LinkDialog);