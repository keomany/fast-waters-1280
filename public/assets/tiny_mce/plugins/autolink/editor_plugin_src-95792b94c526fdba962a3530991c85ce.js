!function(){tinymce.create("tinymce.plugins.AutolinkPlugin",{init:function(t){var n=this;tinyMCE.isIE||(t.onKeyDown.add(function(t,e){return 13==e.keyCode?n.handleEnter(t):void 0}),t.onKeyPress.add(function(t,e){return 41==e.which?n.handleEclipse(t):void 0}),t.onKeyUp.add(function(t,e){return 32==e.keyCode?n.handleSpacebar(t):void 0}))},handleEclipse:function(t){this.parseCurrentLine(t,-1,"(",!0)},handleSpacebar:function(t){this.parseCurrentLine(t,0,"",!0)},handleEnter:function(t){this.parseCurrentLine(t,-1,"",!1)},parseCurrentLine:function(t,n,e){var i,o,r,s,a,l,d,c,u;if(i=t.selection.getRng().cloneRange(),i.startOffset<5){if(c=i.endContainer.previousSibling,null==c){if(null==i.endContainer.firstChild||null==i.endContainer.firstChild.nextSibling)return;c=i.endContainer.firstChild.nextSibling}if(u=c.length,i.setStart(c,u),i.setEnd(c,u),i.endOffset<5)return;o=i.endOffset,s=c}else{if(s=i.endContainer,3!=s.nodeType&&s.firstChild){for(;3!=s.nodeType&&s.firstChild;)s=s.firstChild;i.setStart(s,0),i.setEnd(s,s.nodeValue.length)}o=1==i.endOffset?2:i.endOffset-1-n}r=o;do i.setStart(s,o-2),i.setEnd(s,o-1),o-=1;while(" "!=i.toString()&&""!=i.toString()&&160!=i.toString().charCodeAt(0)&&o-2>=0&&i.toString()!=e);if(i.toString()==e||160==i.toString().charCodeAt(0)?(i.setStart(s,o),i.setEnd(s,r),o+=1):0==i.startOffset?(i.setStart(s,0),i.setEnd(s,r)):(i.setStart(s,o),i.setEnd(s,r)),l=i.toString(),d=l.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|[A-Z0-9._%+-]+@)(.+)$/i),d&&("www."==d[1]?d[1]="http://www.":/@$/.test(d[1])&&(d[1]="mailto:"+d[1]),a=t.selection.getBookmark(),t.selection.setRng(i),tinyMCE.execCommand("createlink",!1,d[1]+d[2]),t.selection.moveToBookmark(a),tinyMCE.isWebKit)){t.selection.collapse(!1);var f=Math.min(s.length,r+1);i.setStart(s,f),i.setEnd(s,f),t.selection.setRng(i)}},getInfo:function(){return{longname:"Autolink",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autolink",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("autolink",tinymce.plugins.AutolinkPlugin)}();